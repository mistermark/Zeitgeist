var ghost=ghost||{};ghost.themes=ghost.themes||{},ghost.themes.zeitgeist=ghost.themes.zeitgeist||{flickrHeist:function(o){"use strict";var e={REST_URL:"http://www.flickr.com/services/rest/",SEARCH:"flickr.photos.search",GETINFO:"flickr.photos.getInfo",PLACEINFO:"flickr.places.getInfo",IMGSIZE:"url_c"};e.PARAMS={api_key:"ce2cebcf703d8ab2bdbd5342f16ebcaa",method:e.SEARCH,format:"json",tags:"movember",safe_search:"1",pages:"1",per_page:"31",nojsoncallback:"1",sort:"interestingness-desc",extras:e.IMGSIZE+",geo,owner_name",has_geo:"1",min_upload_date:"1333238401"};var t=[],a=$(o),n={mock:!1,random:Math.floor(Math.random()*e.PARAMS.per_page)},s=$.param(e.PARAMS),i=e.REST_URL+"?"+s;n.mock===!0&&(i="/assets/js/flickr.photos.search.js");var c=function(){$.ajax({url:i,dataType:"json",data:JSON,error:function(o){console.info(o)},success:function(o){$.each(o.photos.photo,function(o,a){(void 0!==a[e.IMGSIZE]||"undefined"!==a[e.IMGSIZE])&&t.push({id:a.id,details:{src:a[e.IMGSIZE],title:a.title,ownername:"",place_id:a.place_id,geo:{city:"",country:""},page_url:""}})}),console.info("Photo: success ["+n.random+"]")},complete:function(){(void 0!==t[n.random]||"undefined"!==t[n.random])&&(a.addClass("cover-loading").html('<div class="cover-image" style="background-image: url('+t[n.random].details.src+')"><div class="cover-details"><ul class="clearfix"><li class="cover-owner"></li><li class="cover-location"></li></ul></div></div>'),r(t[n.random].id))}})},r=function(o){var s={method:e.GETINFO,api_key:e.PARAMS.api_key,photo_id:o,format:e.PARAMS.format,nojsoncallback:"1"},i=$.param(s),c=e.REST_URL+"?"+i;$.ajax({url:c,dataType:"json",data:JSON,error:function(){console.info("PhotoInfo: error")},success:function(e){console.info("PhotoInfo: success"),$.each(t,function(a,n){n.id===o&&(t[a].details.page_url=e.photo.urls.url[0]._content,e.photo.location.locality&&(t[a].details.geo.city=e.photo.location.locality._content),e.photo.location.country&&(t[a].details.geo.country=e.photo.location.country._content),t[a].details.ownername=e.photo.owner.realname?e.photo.owner.realname:e.photo.owner.username)})},complete:function(){console.info("PhotoInfo: complete");var o=$("<ul/>"),e=$('<li><a href="'+t[n.random].details.page_url+'" title="'+t[n.random].details.title._content+'"><i class="fi-social-flickr"></i>'+t[n.random].details.ownername+"</a></li>"),s=$('<li><i class="fi-marker"></i>'+t[n.random].details.geo.city+", "+t[n.random].details.geo.country+"</li>");o.append(e,s),$(".cover-details",a).html(o),a.removeClass("cover-loading")}})};return c()}},$(document).ready(function(){ghost.themes.zeitgeist.flickrHeist("#cover-image")});